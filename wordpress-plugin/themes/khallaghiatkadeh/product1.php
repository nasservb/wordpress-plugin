<?php
/*!
 * Template Name: رویداد مقدماتی
 * Theme URI: http://Khalaghiatkadeh.com
 * Author: nasser niazy mobasser
 * Author URI: http://niazy.ir/
 * Design: Nov 11, 2016 
 * Copyright: abrezendegi.ir all right reserved.
 */
 
get_header(); 	
?>


<!---machine picture area--->
	<section class="sec-course "  >
        <div class="content-bg"> 
		
		
		
		<div style="width: 85%;
					height: 8px;
					background-color: #C9D1D7;
					border-radius: 15px;
					margin: 25px;
					right: 30px;
					position: relative;">

						<div class="progress_bg" style="width: 0%;">
						</div>
					<span style="background-position: -2px -36px;" class="step-item">

					<a class="s_title" href="#" style="color:blue;">
					رویداد مقدماتی روشا
					</a></span>
					
					<span style="background-position: -2px -70px;right: 33%;" class="step-item">
					<a >
					پیش شتابدهی
					</a></span>									
					<span style="background-position: -2px -70px;right: 66%;" class="step-item">
					<a>
					شتابدهی
					</a></span>
					<span style="background-position: -2px -70px;right: 99%;" class="step-item">
					<a>
					رویداد ملی روشا
					</a></span>
					
		</div> 
		<link rel="stylesheet" href="<?=get_template_directory_uri() ?>/css/blog.css">

<div class="cntainer box"> 
			<div  class="content-box">
				<header class="entry-header"> 
					<div class="about-text" >
						<h1><span class="title">رویداد مقدماتی روشا
</span></h1>
					</div>	
					</header><!-- .entry-header -->
		<div class="container" style="width:100%">
			<div class="row grid">
			
  <h2>• برگزاری رویداری مهیج و پویا برای ساختن رویاهایمان!</h2>

 
<p>رویداد مقدماتی روشا یک رویداد هیجان انگیز، علمی و آموزشی برای انگیزه مند کردن افراد جهت ورود و حضور در دوره های پیش شتابدهی و شتابدهی است، ضمن اینکه ارزیابی اولیه مبتنی بر مشاهده از نواندیش نیز صورت می گیرد.</p>
<p>هر انسانی فكر يا ايده‌اي دارد كه با تمام شور و اشتياق به آن مي‌پردازد، چيزي كه او را به هيجان مي‌آورد، شور و اشتياقش را مي‌افزاید، چشمانش را از حدقه بيرون مي زند، حرف زدنش را سريع تر مي كند و انرژي اش را چند برابر بیشتر! <strong>رویداد مقدماتی روشا </strong>فضای ایده پردازی، اشتراك‌گذاري اين ایده ها، فکرها، تجربيات ناب زندگي‌ساز، موضوعات مورد علاقه و شوق‌برانگيز و نقطه نظرات منحصربه‌فرد است.</p>
<p>در رویدادمقدماتی روشا تلاش کرده ایم ابزارها و فرصت های تجربی فراوانی را جهت بررسی کسب و کار برای نواندیشان ارائه کرده و آن را تبدیل به یک تجربه خوب کنیم. همانند هر تجربه جدیدی، اگر ابزارهای درست، جسارت و فرصت هایی به نواندیشان داده شود، به خوبی می توانند آن را به انجام رسانند.</p>
<p>در &nbsp;این رویداد، با فراهم سازی موقعیتی چالشی، تعاملی و سرگرم کننده درصدد هستیم تا نواندیشان مهارت خود را در حل&nbsp; مسئله بهبود دهند، بتوانند برای مسائل دشوار و چند وجهی زندگی خود، راه حل‌های مؤثر بیابند. رویداد مذکور روشی علمی و عملی با نیت کسب نتایج بهتر در آینده است. دنیای امروز ما نیازمند افراد خلاقی است تا مسائل پیچیده ی امروز را با نگاهی پویا حل کنند. رویداد مذکور فرصت لازم را برای آماده سازی نواندیشان در یک فضای رقابتی فراهم می آورد و بدون شک یکی از مهیج ترین مراحلی است که با بهره گیری از اصولی منحصر بفرد می تواند نواندیشان را برای ادامه مسیر انگیزه مند کند.</p>


<p>&nbsp;</p>
		<table class="table table-bordered table-hovered table-striped">
		<thead>
			<th></th>
			<th>نام دوره</th>
			<th>مدت زمان </th>
			<th>پیش نیاز </th>
			<th>مخاطبین </th>
			<th>قیمت نهایی </th>
		</thead>
		<tbody>
			<tr>
				<td>
				<img class="thumbnail" height="100" width="100" style="width: 100px;height: 100px;min-height: 100px;" src="<?=get_template_directory_uri() ?>/images/course/course1.jpg">
				</td>
				<td>رویداد مقدماتی روشا</td>
				<td>۶ ساعت</td>
				<td>لازم ندارد</td>
				<td>۶ -۱۸ سال</td>
				<td>٤٥,٠٠٠ تومان</td>
			</tr>
		</tbody>
		</table>
		
		
	<?php
	
	if (empty($_POST))
	{
		?>
			<div class="finalprice">
				<div class="total">جمع کل خرید شما :
					<span class="left green">
					   ٤٥,٠٠٠
						<span class="toman">تومان</span>
					</span>
				</div>
				<div class="sep"></div>
				<div class="payable">
					مبلغ قابل پرداخت :
					<span class="left green">
					 ٤٥,٠٠٠
						<span class="toman">تومان</span>
					</span>
				</div>
			</div>		
			
			<script>
			function goPay(id)
			{
				var loggin = <?=(is_user_logged_in()? 1 : 0 )?> ; 
				if(loggin == 1 )
				{
					//if(user) , if(parent), if(agency)
					//windows.location= "<?=site_url(); ?>/parent-profile/?dir=course&p=viewOrder&pid="+id ; 
					$("#form_pay"+id).submit();
				}
				else 
				{
					loginUrl=window.location.href;
					registerUrl=window.location.href;
					
					alert("شما وارد سایت نشده اید .\n از منوی بالای سایت می توانید وارد سایت شوید . \n  اگر کاربری ندارید می توانید از دکمه ثبت نام استفاده کنید.");
				}
			
			}
			</script>

			<form method="POST" name="form_pay"  id="form_pay747"> 
				<input type="hidden" name="pid" value="747"> 
					<button type="button" class="btn btn-success btn-register" style="right:0px;height:50px;padding-top: 10px;font-family:nassim-bold;width:200px" onclick="goPay(747);">
							پرداخت آنلاین و خرید 
						</button><br><br>
					
			</form>			
			</div>
			</div>	
			
		<?php 
	}
	else 
	{
		$product_id = (isset($_REQUEST['pid'])? sanitize_text_field($_REQUEST['pid']) : ''  );
		$product = wc_get_product(  $product_id);
	
	 
		
		$current_user = wp_get_current_user();
		$address = array(
            'name' 			=> $current_user->user_firstname,
            'family'  		=> $current_user->user_lastname,
            'company'    	=> $current_user->user_email,
            'email'      	=> $current_user->user_email,            
			'tel' 			=> $current_user->phone,
			'mobile' 		=> $current_user->mobile,
            'address_1'  	=> '31 Main Street',
            'address_2'  	=> '', 
			'nc' 			=> $current_user->melli,
            'city'       	=> 'Chennai',
            'state'      	=> 'TN',
            'postcode'   	=> '12345',
            'country'    	=> 'IN'
        );

        $order = wc_create_order();
        $order->add_product( get_product( $product_id ), 1 ); //(get_product with id and next is for quantity)
        $order->set_address( $address, 'billing' );
        $order->set_address( $address, 'shipping' );
        //$order->add_coupon('Fresher','10','2'); // accepted param $couponcode, $couponamount,$coupon_tax
        $order->calculate_totals();
		
		$order_id=$order->id;
		if(is_wp_error( $order_id ) )
		{
			
		}
		else 
		{
			//add a bunch of meta data			
			add_post_meta($order_id, '_customer_user', $user_id, true);			
			add_post_meta($order_id, '_order_currency', $order->currency, true);
			add_post_meta($order_id, '_course_id', $product_id, true);
			
			update_post_meta($order_id, '_customer_user', $user_id );
			update_post_meta($order_id, '_payment_method', 'WC_Sharif' );
			update_post_meta($order_id, '_payment_method_title', 'WC_Sharif' );
			update_post_meta($order_id, 'post_author',  $user_id  );
			update_post_meta($order_id, '_course_id',  $product_id  );

		}
		

		
		//Store Order ID in session so it can be re-used after payment failure
		WC()->session->order_awaiting_payment = $order->id;

		//Process Payment
		$available_gateways = WC()->payment_gateways->get_available_payment_gateways();
		$result = $available_gateways[ 'WC_Sharif' ]->process_payment( $order->id );

		//Redirect to success/confirmation/payment page
		if ( $result['result'] == 'success' ) 
		{
			$result = apply_filters( 'woocommerce_payment_successful_result', $result, $order->id );

			//wp_redirect( $result['redirect'] );
			echo '<script>document.location = "'. $result['redirect'] .'";</script>';
			wp_die();
		}
		
	
	}
	?>
	
		
			
		</div>
			</div>	
		</div>
					 
			 
    </section> 
 




 <?php get_footer(); ?> 
 
</body>

</html>
